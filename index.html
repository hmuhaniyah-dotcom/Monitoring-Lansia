<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Monitoring Lansia</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; text-align: center; background: #f0f2f5; padding: 20px; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); display: inline-block; min-width: 300px; }
        h2 { color: #333; }
        #bpm-value { font-size: 48px; color: #e74c3c; font-weight: bold; }
        .status-ok { color: #2ecc71; font-weight: bold; }
        .alert { background: #ff4757; color: white; padding: 10px; border-radius: 5px; margin-bottom: 20px; display: none; }
    </style>
</head>
<body>

    <div id="fall-alert" class="alert">⚠️ PERINGATAN: TERDETEKSI JATUH! ⚠️</div>

    <div class="card">
        <h2>Kondisi Real-time</h2>
        <div id="bpm-value">--</div>
        <p>BPM (Detak Jantung)</p>
        <hr>
        <p>Status: <span id="status-text" class="status-ok">Mencari Data...</span></p>
    </div>

    <script>
        // Konfigurasi KHUSUS untuk proyek Anda
        const firebaseConfig = {
            apiKey: "AIzaSyAOlwN584C4-FuF-yxsV0_LfHgYg66MPs0", // GANTI DENGAN API KEY ASLI DARI PROJECT SETTINGS
            databaseURL: "https://tubes-iot-c14b6-default-rtdb.firebaseio.com/",
            projectId: "tubes-iot-c14b6"
        };

        // Inisialisasi Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Mengambil data dari root ("/") agar lebih pasti terbaca
        db.ref('/').on('value', (snapshot) => {
            const data = snapshot.val();
            console.log("Data diterima:", data); // Cek di F12 Console

            if (data) {
                // Jika data dikirim langsung ke root (tanpa folder Lansia1)
                const heartRate = data.heartRate || data.bpm || "--";
                const status = data.Status || "Normal";

                document.getElementById('bpm-value').innerText = heartRate;
                document.getElementById('status-text').innerText = status;

                // Cek Alert Jatuh
                if (status === "JATUH!" || data.isFalling === true) {
                    document.getElementById('fall-alert').style.display = 'block';
                } else {
                    document.getElementById('fall-alert').style.display = 'none';
                }
            }
        }, (error) => {
            console.error("Gagal baca database:", error);
        });
    </script>
</body>
</html>

